(()=>{"use strict";var t,n={514:(t,n)=>{n.__esModule=!0,n.Connector=void 0;var e=function(){function t(){this.gateMap=new Map}return t.prototype.registerGate=function(t,n){this.gateMap.set(t,n)},t.prototype.unregisterGate=function(t){this.gateMap.delete(t)},t.prototype.getGate=function(t){if(!this.gateMap.has(t))throw new Error("get does not exist for sandbox: "+t);return this.gateMap.get(t)},t.prototype.onStart=function(t){this.getGate(t).onStart()},t.prototype.onUpdate=function(t){this.getGate(t).onUpdate()},t}();n.Connector=e},61:(t,n)=>{n.__esModule=!0;var e=function(){function t(){this.wasmInstance=null,this.wasmMemory=null}return t.prototype.setWasm=function(t){this.wasmInstance=t},t.prototype.getWasmInstance=function(){if(this.wasmInstance)return this.wasmInstance;throw new Error("WASM instance is not set yet.")},t.prototype.getWasmMemory=function(){var t=this.getWasmInstance();if(t.exports.memory)return t.exports.memory;throw new Error("No memory export.")},t.prototype.malloc=function(t){for(var n=new Uint8Array(this.getWasmMemory().buffer),e=0,i=0;i<n.length;i++)if(0===n[i]){if(t+2===(e+=1))return i-t+1}else e=0;throw new Error("No free memory")},t.prototype.free=function(t){for(var n=new Uint8Array(this.getWasmMemory().buffer),e=0;e<n.length&&0!==n[t+e];e++)n[e]=0},t.prototype.onStart=function(){this.getWasmInstance().exports.start()},t.prototype.onUpdate=function(){this.getWasmInstance().exports.update()},t.prototype.onAbort=function(t,n,e,i){},t.prototype._logString=function(t,n){var e=new Uint8Array(this.getWasmMemory().buffer.slice(t,t+n)),i=[];e.forEach((function(t){return i.push(t)})),this.logString(String.fromCharCode.apply(String,i))},t.prototype.logString=function(t){console.log(t)},t.prototype.logInt=function(t){console.log(t)},t.prototype.logFloat=function(t){console.log(t)},t.prototype.createImport=function(){return{logString:this._logString.bind(this),logInt:this.logInt.bind(this),logFloat:this.logFloat.bind(this),_callEngine_i_i:this._callEngine_i_i.bind(this),_callEngine_i_ii:this._callEngine_i_ii.bind(this),_callEngine_i_s:this._callEngine_i_s.bind(this),_callEngine_i_ifff:this._callEngine_i_ifff.bind(this),_callEngine_i_iffff:this._callEngine_i_iffff.bind(this),_callEngine_fff_i:this._callEngine_fff_i.bind(this)}},t.prototype.callEngine_i_i=function(t,n){return new Uint8Array},t.prototype.callEngine_i_ii=function(t,n,e){return new Uint8Array},t.prototype.callEngine_i_s=function(t,n,e){return new Uint8Array},t.prototype.callEngine_i_ifff=function(t,n,e,i,r){return new Uint8Array},t.prototype.callEngine_i_iffff=function(t,n,e,i,r,o){return new Uint8Array},t.prototype.callEngine_fff_i=function(t,n){return new Uint8Array},t.prototype._callEngine_i_i=function(t,n){for(var e=this.malloc(4),i=this.callEngine_i_i(t,n),r=new Uint8Array(this.getWasmMemory().buffer),o=0;o<i.length;o++)r[o]=i[o];return e},t.prototype._callEngine_i_ii=function(t,n,e){for(var i=this.malloc(4),r=this.callEngine_i_ii(t,n,e),o=new Uint8Array(this.getWasmMemory().buffer),a=0;a<r.length;a++)o[a]=r[a];return i},t.prototype._callEngine_i_s=function(t,n,e){for(var i=this.malloc(4),r=this.callEngine_i_s(t,n,e),o=new Uint8Array(this.getWasmMemory().buffer),a=0;a<r.length;a++)o[a]=r[a];return i},t.prototype._callEngine_i_ifff=function(t,n,e,i,r){for(var o=this.malloc(4),a=this.callEngine_i_ifff(t,n,e,i,r),s=new Uint8Array(this.getWasmMemory().buffer),l=0;l<a.length;l++)s[l]=a[l];return o},t.prototype._callEngine_i_iffff=function(t,n,e,i,r,o){for(var a=this.malloc(4),s=this.callEngine_i_iffff(t,n,e,i,r,o),l=new Uint8Array(this.getWasmMemory().buffer),u=0;u<s.length;u++)l[u]=s[u];return a},t.prototype._callEngine_fff_i=function(t,n){for(var e=this.malloc(12),i=this.callEngine_fff_i(t,n),r=new Uint8Array(this.getWasmMemory().buffer),o=0;o<i.length;o++)r[o]=i[o];return e},t}();n.default=e},979:function(t,n,e){var i,r=this&&this.__extends||(i=function(t,n){return(i=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,n){t.__proto__=n}||function(t,n){for(var e in n)Object.prototype.hasOwnProperty.call(n,e)&&(t[e]=n[e])})(t,n)},function(t,n){if("function"!=typeof n&&null!==n)throw new TypeError("Class extends value "+String(n)+" is not a constructor or null");function e(){this.constructor=t}i(t,n),t.prototype=null===n?Object.create(n):(e.prototype=n.prototype,new e)}),o=this&&this.__importDefault||function(t){return t&&t.__esModule?t:{default:t}};n.__esModule=!0;var a=function(t){function n(n){var e=t.call(this)||this;return e.connector=n,e}return r(n,t),n.prototype.getUnityInstance=function(){return this.connector.unityInstance},n.prototype.getUnityModule=function(){return this.getUnityInstance().Module},n.prototype.getUnityPointers=function(){return this.connector.unityPointers},n.prototype.passStringFromWasmToUnity=function(t,n){var e=new Uint8Array(this.getWasmMemory().buffer.slice(t,t+n)),i=this.getUnityModule()._malloc(n);return this.getUnityModule().HEAP8.set(e,i),i},n.prototype.callEngine_i_ii=function(t,n,e){console.log(t,n,e);var i=this.getUnityModule().dynCall_iiii(this.getUnityPointers().execI_II,t,n,e);return new Uint8Array(new Uint32Array([i]).buffer)},n.prototype.callEngine_i_i=function(t,n){var e=this.getUnityModule().dynCall_iii(this.getUnityPointers().execI_I,t,n);return new Uint8Array(new Uint32Array([e]).buffer)},n.prototype.callEngine_i_s=function(t,n,e){var i=this.passStringFromWasmToUnity(n,e),r=this.getUnityModule().dynCall_iii(this.getUnityPointers().execI_S,t,i);return new Uint8Array(new Uint32Array([r]).buffer)},n.prototype.callEngine_i_ifff=function(t,n,e,i,r){var o=this.getUnityModule().dynCall_iiifff(this.getUnityPointers().execI_IV3,t,n,e,i,r);return new Uint8Array(new Uint32Array([o]).buffer)},n.prototype.callEngine_i_iffff=function(t,n,e,i,r,o){var a=this.getUnityModule().dynCall_iiiffff(this.getUnityPointers().execI_IV4,t,n,e,i,r,o);return new Uint8Array(new Uint32Array([a]).buffer)},n.prototype.callEngine_fff_i=function(t,n){var e=this.getUnityModule().dynCall_iii(this.getUnityPointers().execV3_I,t,n)>>2;return new Uint8Array(this.getUnityModule().HEAP32.buffer.slice(e,e+2))},n}(o(e(61)).default);n.default=a},996:function(t,n,e){var i,r=this&&this.__extends||(i=function(t,n){return(i=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,n){t.__proto__=n}||function(t,n){for(var e in n)Object.prototype.hasOwnProperty.call(n,e)&&(t[e]=n[e])})(t,n)},function(t,n){if("function"!=typeof n&&null!==n)throw new TypeError("Class extends value "+String(n)+" is not a constructor or null");function e(){this.constructor=t}i(t,n),t.prototype=null===n?Object.create(n):(e.prototype=n.prototype,new e)}),o=this&&this.__awaiter||function(t,n,e,i){return new(e||(e=Promise))((function(r,o){function a(t){try{l(i.next(t))}catch(t){o(t)}}function s(t){try{l(i.throw(t))}catch(t){o(t)}}function l(t){var n;t.done?r(t.value):(n=t.value,n instanceof e?n:new e((function(t){t(n)}))).then(a,s)}l((i=i.apply(t,n||[])).next())}))},a=this&&this.__generator||function(t,n){var e,i,r,o,a={label:0,sent:function(){if(1&r[0])throw r[1];return r[1]},trys:[],ops:[]};return o={next:s(0),throw:s(1),return:s(2)},"function"==typeof Symbol&&(o[Symbol.iterator]=function(){return this}),o;function s(o){return function(s){return function(o){if(e)throw new TypeError("Generator is already executing.");for(;a;)try{if(e=1,i&&(r=2&o[0]?i.return:o[0]?i.throw||((r=i.return)&&r.call(i),0):i.next)&&!(r=r.call(i,o[1])).done)return r;switch(i=0,r&&(o=[2&o[0],r.value]),o[0]){case 0:case 1:r=o;break;case 4:return a.label++,{value:o[1],done:!1};case 5:a.label++,i=o[1],o=[0];continue;case 7:o=a.ops.pop(),a.trys.pop();continue;default:if(!((r=(r=a.trys).length>0&&r[r.length-1])||6!==o[0]&&2!==o[0])){a=0;continue}if(3===o[0]&&(!r||o[1]>r[0]&&o[1]<r[3])){a.label=o[1];break}if(6===o[0]&&a.label<r[1]){a.label=r[1],r=o;break}if(r&&a.label<r[2]){a.label=r[2],a.ops.push(o);break}r[2]&&a.ops.pop(),a.trys.pop();continue}o=n.call(t,a)}catch(t){o=[6,t],i=0}finally{e=r=0}if(5&o[0])throw o[1];return{value:o[0]?o[1]:void 0,done:!0}}([o,s])}}},s=this&&this.__importDefault||function(t){return t&&t.__esModule?t:{default:t}};n.__esModule=!0,n.UnityConnector=void 0;var l=e(514),u=s(e(979)),c=function(t){function n(n,e){var i=t.call(this)||this;return i.unityInstance=n,i.unityPointers=e,i}return r(n,t),n.prototype.load=function(t,n){return o(this,void 0,void 0,(function(){var e,i,r,o;return a(this,(function(a){switch(a.label){case 0:console.log(t),console.log(n),a.label=1;case 1:return a.trys.push([1,6,,7]),[4,fetch(n)];case 2:return[4,a.sent().blob()];case 3:return[4,a.sent().arrayBuffer()];case 4:return e=a.sent(),i=new u.default(this),[4,WebAssembly.instantiate(e,{env:{abort:i.onAbort.bind(i)},gate:i.createImport()})];case 5:return r=a.sent(),i.setWasm(r.instance),this.registerGate(t,i),this.unityInstance.Module.dynCall_vii(this.unityPointers.onLoadCompleted,t,0),[3,7];case 6:return o=a.sent(),console.log(o),this.unityInstance.Module.dynCall_vii(this.unityPointers.onLoadCompleted,t,1),[3,7];case 7:return[2]}}))}))},n.prototype.requestLoad=function(t){var n=(new TextEncoder).encode(t+String.fromCharCode(0)),e=this.unityInstance.Module._malloc(n.length);this.unityInstance.Module.HEAP8.set(n,e),this.unityInstance.Module.dynCall_vi(this.unityPointers.onLoadRequested,e)},n.prototype.requestDelete=function(t){this.unityInstance.Module.dynCall_vi(this.unityPointers.onDeleteRequested,t),this.unregisterGate(t)},n.prototype.requestDeleteAll=function(){var t=this;this.gateMap.forEach((function(n,e){t.requestDelete(e)}))},n}(l.Connector);n.UnityConnector=c}},e={};t=function t(i){var r=e[i];if(void 0!==r)return r.exports;var o=e[i]={exports:{}};return n[i].call(o.exports,o,o.exports,t),o.exports}(996),window.Connector=t.UnityConnector})();